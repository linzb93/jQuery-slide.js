/*
 * slide.js V3.0
 *
 * https://github.com/linzb93/slide.js
 * @license MIT licensed
 *
 * Copyright (C) 2017 linzb93
 *
 * Date: 2017-04-08
 */

!function(t){"use strict";function i(i,s){if(this.opt=t.extend(!0,{},e,s),this.$this=i,this._$wrapper=this.$this.children(this.opt.wrapper),this._$list=this._$wrapper.children(),this._$cell=this._$list.children(),this._$btNprev=this.$this.children(this.opt.prev),this._$btNnext=this.$this.children(this.opt.next),"string"===t.type(this.opt.pagination)){var h=this.opt.pagination;this.opt.pagination={selector:h,type:"dot",event:"click"}}this.opt.pagination.selector&&(this._$pagination=this.$this.children(this.opt.pagination.selector)||t(this.opt.pagination.selector)),this._$widget=this._$btNprev.add(this._$btNnext).add(this._$pagination),this.length=this._$cell.length,this.curIndex=0,this._cellSize="h"===this.opt.dir?this._$cell.outerWidth(!0):this._$cell.outerHeight(!0),this._length=1===this.opt.perGroup?this.length:Math.ceil((this.length-this.opt.perGroup)/this.opt.slidePerView)+1,this._canSlide=!1,this._loadImgLen=0,this._needDuplicateEdge=this.opt.interval||this.opt.next,this._init()}var e={wrapper:".slide-wrapper",dir:"h",speed:500,prev:"",next:"",effect:"fade",pagination:{selector:"",type:"dot",event:"click"},interval:0,perGroup:1,slidePerView:1,easing:"swing",lazyload:!1,enableHideWidget:!1,beforeCreate:t.noop,afterCreate:t.noop,beforeSlide:t.noop,afterSlide:t.noop},s="slide-active";i.prototype={constructor:i,_init:function(){if(this.opt.beforeCreate(),"fade"===this.opt.effect)this._$wrapper.width(this._cellSize).height(this._$cell.height()),this._$list.addClass("slide-pile"),this._$cell.hide().first().show();else{var t=this._cellSize*this.opt.perGroup,i=this._cellSize*this._$cell.length;this._$wrapper.addClass("slide-container"),"h"===this.opt.dir?(this._$wrapper.width(t),this._$list.width(i)):(this._$wrapper.height(t),this._$list.height(i)),this._$list.addClass("slide-"+this.opt.dir)}this._$cell.first().addClass(s),this._$pagination&&this._createPagination(),this.opt.lazyload&&(this._lazyload(0),"slide"===this.opt.effect&&this._lazyload(-1)),"slide"===this.opt.effect&&this._needDuplicateEdge&&this._duplicateEdge(),this._initEvent(),this.opt.afterCreate(),this.play(),"marquee"===this.opt.effect&&this._marqueeHandler()},_createPagination:function(){if("outer"!==this.opt.pagination.type){for(var t="",i=0;i<this._length;i++){var e;switch(this.opt.pagination.type){case"dot":e="";break;case"num":e=i+1;break;case"image":var s=this._$cell.eq(i);e='<img src="'+(s.find("img").attr("src")||s.css("background-image").slice(5,-2))+'">'}t+='<a href="javascript:;" >'+e+"</a>"}this._$pagination.html(t)}this._$pageChild=this._$pagination.children(),this._$pageChild.first().addClass("on")},_initEvent:function(){var i=this;if(this.opt.pagination.selector)var e=this._$pageChild[0].nodeName.toLowerCase();(this.opt.prev||this.opt.next)&&(this._$btNprev.on("click",function(){i.slidePrev()}),this._$btNnext.on("click",function(){i.slideNext()})),this._$pageChild&&this._$pagination.on(this.opt.pagination.event,e,function(){var e=t(this).index();e!==i.curIndex&&i.slideTo(e)}),this.$this.on({mouseenter:function(){(i.opt.interval||"marquee"===i.opt.effect)&&(i.stop(),i._$list.clearQueue()),i.opt.enableHideWidget&&i._$widget.fadeIn()},mouseleave:function(){i.opt.interval&&i.play(),"marquee"===i.opt.effect&&i._marqueeHandler(),i.opt.enableHideWidget&&i._$widget.fadeOut()}})},stop:function(){clearInterval(this.timer)},play:function(){var t=this;this.opt.interval&&(this.timer=setInterval(function(){t.slideNext()},this.opt.interval))},slidePrev:function(){this._totalSlideHandler("prev")},slideNext:function(){this._totalSlideHandler("next")},slideTo:function(t){this._totalSlideHandler("to",t)},_totalSlideHandler:function(i,e){var s=this;t.each(["fade","slide","carousel","return"],function(t,h){s.opt.effect===h&&s["_"+h+"Handler"].apply(s,[i,e])})},_slideHandler:function(t,i){this._canSlide||("prev"===t?(this.curIndex||(this._canSlide=!0),this.curIndex-=1):"next"===t?(this.curIndex===this.length-1&&(this._canSlide=!0),this.curIndex+=1):this.curIndex=i,this._slidePage(this.curIndex))},_carouselHandler:function(t,i){"prev"===t?this.curIndex=this.curIndex?this.curIndex-1:this._length-1:"next"===t?this.curIndex=this.curIndex===this._length-1?0:this.curIndex+1:this.curIndex=i,this._slidePage(this.curIndex)},_fadeHandler:function(t,i){"prev"===t?this.curIndex=this.curIndex?this.curIndex-1:this.length-1:"next"===t?this.curIndex=this.curIndex<this.length-1?this.curIndex+1:0:this.curIndex=i,this._slideFade(this.curIndex)},_marqueeHandler:function(){var t=this;this.opt.easing="linear",this.timer=setInterval(function(){t.curIndex<t._$cell.length-t.opt.perGroup?t._slidePage(++t.curIndex):(t.curIndex=-1,setTimeout(function(){"h"===t.opt.dir?t._$list.css("left",0):t._$list.css("top",0)},t.opt.speed))},t.opt.speed+20)},_duplicateEdge:function(){var t=-this._cellSize+"px",i=this._cellSize*(this.length+2);this._$cell.first().removeClass(s).clone().appendTo(this._$list),this._$cell.last().clone().prependTo(this._$list),this._$cell.first().addClass(s),"h"===this.opt.dir?(this._$list.css("width",i),this._$list.css("left",t)):(this._$list.css("height",i),this._$list.css("top",t))},_lazyload:function(i){var e=this._$cell.eq(i);e.attr("data-bg")?(e.css("background-image",e.data("bg")).removeAttr("data-bg"),this._loadImgLen++):e.find("img").attr("data-src")&&(e.find("img").each(function(){t(this).attr("src",t(this).data("src")),t(this).removeAttr("data-src")}),this._loadImgLen++)},_dobeforeSlide:function(){this.opt.lazyload&&this._loadImgLen<=this._$cell.length&&this._lazyload(this.curIndex),this.opt.beforeSlide(this.curIndex-1,this._$cell.eq(this.curIndex-1))},_slidePage:function(t){this._dobeforeSlide(t);var i=this,e="slide"===this.opt.effect&&this._needDuplicateEdge?t+1:t,s=-e*this._cellSize*this.opt.slidePerView;"h"===this.opt.dir?this._$list.stop(!0).animate({left:s},this.opt.speed,this.opt.easing,function(){i._slideCallBack(t)}):this._$list.stop(!0).animate({top:s},this.opt.speed,this.opt.easing,function(){i._slideCallBack(t)})},_slideFade:function(t){this._dobeforeSlide();var i=this;this._$cell.eq(t).fadeIn(this.opt.speed,function(){i._slideCallBack(t)}).siblings().fadeOut(this.opt.speed)},_currentClassChange:function(t){this._$pagination&&this._$pageChild.removeClass("on").eq(t).addClass("on"),"marquee"!==this.opt.effect&&this._$cell.removeClass(s).eq(t).addClass(s)},_slideCallBack:function(t){if("slide"===this.opt.effect){var i="h"===this.opt.dir?"left":"top";this.curIndex===-1?(this.curIndex=this.length-1,this._$list.css(i,-this._cellSize*this.length)):this.curIndex===this.length&&(this.curIndex=0,this._$list.css(i,-this._cellSize)),this._canSlide=!1}else"marquee"===this.opt.effect&&(this.curIndex=t);this._currentClassChange(this.curIndex),this.opt.afterSlide(this.curIndex,this._$cell.eq(this.curIndex))}},t.fn.slide=function(e){return new i(t(this),e)}}(jQuery);